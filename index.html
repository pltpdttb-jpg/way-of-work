<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Strategy & Activity Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Prompt', sans-serif; background-color: #F1F5F9; }
        .font-head { font-family: 'Inter', sans-serif; }
        .input-box { 
            @apply w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all;
        }
        .section-card {
            @apply bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6;
        }
        .btn-primary {
            @apply bg-slate-900 text-white px-6 py-2.5 rounded-lg hover:bg-slate-800 transition-colors font-medium shadow-md w-full md:w-auto text-center;
        }
        .rate-input {
            @apply w-20 text-center border-b-2 border-blue-200 bg-blue-50 focus:border-blue-600 focus:outline-none py-1 text-blue-900 font-bold;
        }
    </style>
</head>
<body class="text-slate-800">

    <nav class="bg-slate-900 text-white py-4 shadow-md">
        <div class="max-w-5xl mx-auto px-4 flex justify-between items-center">
            <div class="font-head font-bold text-xl tracking-wide">FINANCIAL <span class="text-emerald-400">ADVISOR</span> SIMULATOR</div>
            <div class="text-xs text-slate-400">Training Mode: v2.1</div>
        </div>
    </nav>

    <div class="max-w-5xl mx-auto px-4 py-8">
        
        <div class="section-card border-l-4 border-l-emerald-500">
            <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                üìÇ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå (Scenario)
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                    <p class="text-xs text-slate-500 uppercase font-semibold mb-1">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (Target APE)</p>
                    <p class="text-2xl font-bold text-slate-900" id="scenarioTarget">1,000,000</p>
                    <p class="text-xs text-slate-400 mt-1">‡∏ö‡∏≤‡∏ó (Issued)</p>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                    <p class="text-xs text-slate-500 uppercase font-semibold mb-1">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏° (Past Performance)</p>
                    <div class="flex justify-between items-end">
                        <div>
                            <p class="text-lg font-bold text-slate-700">600,000 APE</p>
                            <p class="text-xs text-slate-400">Total Year</p>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-bold text-slate-700">12 Cases</p>
                            <p class="text-xs text-slate-400">Total Count</p>
                        </div>
                    </div>
                </div>
                <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                    <p class="text-xs text-slate-500 uppercase font-semibold mb-1">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (Issued Rate)</p>
                    <p class="text-2xl font-bold text-emerald-600" id="scenarioRate">80%</p>
                    <p class="text-xs text-slate-400 mt-1">‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</p>
                </div>
            </div>
        </div>

        <div class="section-card">
            <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                1Ô∏è‚É£ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå (Financial Strategy)
            </h2>
            <p class="text-sm text-slate-500 mb-6">‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏Ñ‡∏™ (Case Size) ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏î‡∏ô‡∏≥‡∏™‡πà‡∏á (Submit) ‡πÉ‡∏´‡πâ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞ Issued Rate</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏Ñ‡∏™‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Case Size)</label>
                    <input type="number" id="inputCaseSize" class="input-box" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ö‡∏≤‡∏ó (‡πÄ‡∏ä‡πà‡∏ô 50000)" value="50000">
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ô‡∏≥‡∏™‡πà‡∏á (APE Submitted)</label>
                    <input type="number" id="inputSubmit" class="input-box" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ö‡∏≤‡∏ó" value="1250000">
                </div>
            </div>
            
            <button onclick="checkPart1()" class="btn-primary">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (Verify Strategy)</button>
            
            <div id="resultPart1" class="hidden mt-4 p-4 rounded-lg bg-gray-50 border border-gray-200 text-sm"></div>
        </div>

        <div id="part2Section" class="section-card opacity-50 pointer-events-none transition-opacity duration-300">
            <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                2Ô∏è‚É£ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (Activity Funnel)
            </h2>
            <p class="text-sm text-slate-500 mb-6">‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î Conversion Rate (%) ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</p>

            <div class="space-y-6">
                
                <div class="flex flex-col md:flex-row items-center gap-4 bg-slate-50 p-4 rounded-lg border border-slate-100">
                    <div class="flex-1 w-full">
                        <label class="text-xs font-bold text-slate-500 uppercase">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ (Leads)</label>
                        <input type="number" id="inputLeads" class="input-box bg-white mt-1" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠" value="100">
                    </div>
                    <div class="flex flex-col items-center justify-center w-full md:w-auto px-4">
                        <span class="text-xs text-slate-400 mb-1">Call Rate %</span>
                        <input type="number" id="rateCall" class="rate-input" value="30">
                        <div class="h-8 w-0.5 bg-blue-200 mt-2"></div>
                        <div class="text-[10px] text-blue-400">‚ñº</div>
                    </div>
                    <div class="flex-1 w-full">
                        <label class="text-xs font-bold text-slate-500 uppercase">‡πÇ‡∏ó‡∏£‡∏ô‡∏±‡∏î (Calls)</label>
                        <input type="number" id="inputCalls" class="input-box bg-white mt-1" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏ó‡∏£" value="30">
                    </div>
                </div>

                <div class="flex flex-col md:flex-row items-center gap-4 bg-slate-50 p-4 rounded-lg border border-slate-100">
                    <div class="flex-1 w-full text-center md:text-right text-sm text-slate-400 hidden md:block">...‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÇ‡∏ó‡∏£</div>
                    <div class="flex flex-col items-center justify-center w-full md:w-auto px-4">
                        <span class="text-xs text-slate-400 mb-1">Meet Rate %</span>
                        <input type="number" id="rateMeet" class="rate-input" value="50">
                        <div class="h-8 w-0.5 bg-blue-200 mt-2"></div>
                        <div class="text-[10px] text-blue-400">‚ñº</div>
                    </div>
                    <div class="flex-1 w-full">
                        <label class="text-xs font-bold text-slate-500 uppercase">‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏ö (Meetings)</label>
                        <input type="number" id="inputMeets" class="input-box bg-white mt-1" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏ö" value="15">
                    </div>
                </div>

                <div class="flex flex-col md:flex-row items-center gap-4 bg-slate-50 p-4 rounded-lg border border-slate-100">
                    <div class="flex-1 w-full text-center md:text-right text-sm text-slate-400 hidden md:block">...‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏ö</div>
                    <div class="flex flex-col items-center justify-center w-full md:w-auto px-4">
                        <span class="text-xs text-slate-400 mb-1">Present Rate %</span>
                        <input type="number" id="ratePresent" class="rate-input" value="80">
                        <div class="h-8 w-0.5 bg-blue-200 mt-2"></div>
                        <div class="text-[10px] text-blue-400">‚ñº</div>
                    </div>
                    <div class="flex-1 w-full">
                        <label class="text-xs font-bold text-slate-500 uppercase">‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠ (Presentations)</label>
                        <input type="number" id="inputPres" class="input-box bg-white mt-1" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠" value="12">
                    </div>
                </div>

                <div class="flex flex-col md:flex-row items-center gap-4 bg-emerald-50 p-4 rounded-lg border border-emerald-100">
                    <div class="flex-1 w-full text-center md:text-right text-sm text-slate-400 hidden md:block">...‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠</div>
                    <div class="flex flex-col items-center justify-center w-full md:w-auto px-4">
                        <span class="text-xs text-emerald-600 font-bold mb-1">Close Rate %</span>
                        <input type="number" id="rateClose" class="rate-input bg-emerald-100 border-emerald-300 text-emerald-800 focus:border-emerald-600" value="50">
                        <div class="h-8 w-0.5 bg-emerald-300 mt-2"></div>
                        <div class="text-[10px] text-emerald-600">‚ñº</div>
                    </div>
                    <div class="flex-1 w-full">
                        <label class="text-xs font-bold text-emerald-700 uppercase">‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ (Closed Cases)</label>
                        <input type="number" id="inputClosed" class="input-box border-emerald-300 bg-white mt-1 font-bold text-emerald-800" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢" value="6">
                    </div>
                </div>

            </div>

            <div class="mt-8">
                <button onclick="analyzeFunnel()" class="btn-primary bg-emerald-600 hover:bg-emerald-700 w-full">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (Analyze Activity)</button>
            </div>
            
        </div>

        <div id="analysisReport" class="hidden section-card border-t-4 border-t-indigo-500 bg-slate-50">
            <h2 class="text-xl font-bold text-indigo-900 mb-4">üìä ‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û (Performance Audit)</h2>
            <div id="reportContent" class="space-y-4">
                </div>
        </div>

    </div>

    <script>
        // --- 1. CONFIGURATION & SCENARIO ---
        const SCENARIO = {
            targetAPE: 1000000,
            pastAvgCase: 50000, // ‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ 600k / 12 cases
            issuedRate: 0.80 // 80%
        };

        // --- 2. PART 1 LOGIC ---
        let plannedCaseSize = 0;
        let plannedSubmit = 0;

        function checkPart1() {
            const size = parseFloat(document.getElementById('inputCaseSize').value);
            const submit = parseFloat(document.getElementById('inputSubmit').value);
            const resultDiv = document.getElementById('resultPart1');
            const part2 = document.getElementById('part2Section');

            if (!size || !submit) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô");
                return;
            }

            plannedCaseSize = size;
            plannedSubmit = submit;

            // Calculation
            const expectedIssue = submit * SCENARIO.issuedRate;
            const isTargetMet = expectedIssue >= SCENARIO.targetAPE;
            const casesNeeded = Math.ceil(submit / size);

            let html = '';
            if (isTargetMet) {
                html += `<div class="text-emerald-700 font-bold mb-2">‚úÖ ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå!</div>`;
                html += `<ul class="list-disc pl-5 text-slate-600 space-y-1">`;
                html += `<li>‡∏Ñ‡∏∏‡∏ì‡∏ß‡∏≤‡∏á‡πÄ‡∏õ‡πâ‡∏≤ Submit <strong>${submit.toLocaleString()}</strong> x 80% = <strong>${expectedIssue.toLocaleString()}</strong> (‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤ 1M)</li>`;
                html += `<li>‡∏î‡πâ‡∏ß‡∏¢ Case Size <strong>${size.toLocaleString()}</strong> ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì <strong>${casesNeeded} ‡∏£‡∏≤‡∏¢</strong></li>`;
                html += `</ul>`;
                
                // Unlock Part 2
                part2.classList.remove('opacity-50', 'pointer-events-none');
                
                // Pre-fill target cases for user convenience (optional, but helpful)
                // document.getElementById('inputClosed').value = casesNeeded;
                
            } else {
                html += `<div class="text-red-600 font-bold mb-2">‚ùå ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</div>`;
                html += `<p class="text-slate-600">Submit ${submit.toLocaleString()} ‡∏à‡∏∞‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${expectedIssue.toLocaleString()} ‡∏ã‡∏∂‡πà‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πâ‡∏≤ 1,000,000</p>`;
                html += `<p class="text-sm mt-2 font-semibold">‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≠‡∏î Submit ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ${(SCENARIO.targetAPE / SCENARIO.issuedRate).toLocaleString()}</p>`;
                
                // Lock Part 2
                part2.classList.add('opacity-50', 'pointer-events-none');
            }

            resultDiv.innerHTML = html;
            resultDiv.classList.remove('hidden');
            if(isTargetMet) resultDiv.classList.add('bg-emerald-50', 'border-emerald-200');
            else resultDiv.classList.add('bg-red-50', 'border-red-200');
        }

        // --- 3. PART 2 LOGIC & ANALYSIS ---
        function analyzeFunnel() {
            // Get Inputs
            const leads = parseFloat(document.getElementById('inputLeads').value) || 0;
            const calls = parseFloat(document.getElementById('inputCalls').value) || 0;
            const meets = parseFloat(document.getElementById('inputMeets').value) || 0;
            const pres = parseFloat(document.getElementById('inputPres').value) || 0;
            const closed = parseFloat(document.getElementById('inputClosed').value) || 0;

            const rCall = parseFloat(document.getElementById('rateCall').value) / 100;
            const rMeet = parseFloat(document.getElementById('rateMeet').value) / 100;
            const rPres = parseFloat(document.getElementById('ratePresent').value) / 100;
            const rClose = parseFloat(document.getElementById('rateClose').value) / 100;

            const reportDiv = document.getElementById('analysisReport');
            const contentDiv = document.getElementById('reportContent');
            reportDiv.classList.remove('hidden');

            let feedback = [];

            // 3.1 Math Check (Consistency)
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ User ‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö Rate ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            const checkStep = (prev, current, rate, name) => {
                const calculated = Math.round(prev * rate);
                const diff = Math.abs(current - calculated);
                // ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ (+/- 1-2 units)
                if (diff > 2 && prev > 0) {
                    return `<div class="p-3 bg-amber-50 border border-amber-200 rounded text-amber-800 text-sm">
                        ‚ö†Ô∏è <strong>‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á (${name}):</strong> 
                        ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ ${prev} ‡∏£‡∏≤‡∏¢ ‡πÅ‡∏õ‡∏•‡∏á ${Math.round(rate*100)}% ‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì <strong>${calculated}</strong> ‡∏£‡∏≤‡∏¢ 
                        (‡πÅ‡∏ï‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏£‡∏≠‡∏Å ${current})
                    </div>`;
                }
                return "";
            };

            feedback.push(checkStep(leads, calls, rCall, "Leads -> Calls"));
            feedback.push(checkStep(calls, meets, rMeet, "Calls -> Meets"));
            feedback.push(checkStep(meets, pres, rPres, "Meets -> Pres"));
            feedback.push(checkStep(pres, closed, rClose, "Pres -> Close"));

            // 3.2 Target Check
            const requiredCases = Math.ceil(plannedSubmit / plannedCaseSize);
            if (closed < requiredCases) {
                feedback.push(`<div class="p-3 bg-red-50 border border-red-200 rounded text-red-800 text-sm font-bold">
                    ‚ùå ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏≠: ‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ ${requiredCases} ‡∏£‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡πÅ‡∏ú‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á ${closed} ‡∏£‡∏≤‡∏¢
                </div>`);
            } else {
                feedback.push(`<div class="p-3 bg-emerald-50 border border-emerald-200 rounded text-emerald-800 text-sm font-bold">
                    ‚úÖ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢! (${closed} ‡∏£‡∏≤‡∏¢)
                </div>`);
            }

            // 3.3 Bottleneck Analysis & Improvement Suggestions
            // ‡∏™‡∏°‡∏°‡∏ï‡∏¥ Benchmark: Call 30%, Meet 50%, Pres 70%, Close 50%
            const analyzeWeakness = (rate, benchmark, name, impactFunc) => {
                if (rate < benchmark) {
                    const improvement = benchmark - rate;
                    const saved = impactFunc();
                    return `<div class="p-4 bg-white border-l-4 border-indigo-500 shadow-sm rounded">
                        <h4 class="font-bold text-indigo-900 mb-1">üí° ‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô: ${name} (${(rate*100).toFixed(0)}%)</h4>
                        <p class="text-sm text-slate-600 mb-2">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (${(benchmark*100).toFixed(0)}%) ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÑ‡∏î‡πâ:</p>
                        <p class="text-sm font-bold text-emerald-600">
                            ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Leads ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏•‡∏á‡πÑ‡∏î‡πâ‡∏ñ‡∏∂‡∏á ${saved} ‡∏£‡∏≤‡∏¢!
                        </p>
                    </div>`;
                }
                return "";
            };

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Lead ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô‡∏ô‡∏µ‡πâ (Reverse Calculate)
            // Formula: Leads = TargetClosed / (rCall * rMeet * rPres * rClose)
            const currentTotalConv = rCall * rMeet * rPres * rClose;
            
            // Analyze Close Rate Weakness
            feedback.push(analyzeWeakness(rClose, 0.50, "Closing Rate", () => {
                const improvedConv = rCall * rMeet * rPres * 0.50; // ‡∏õ‡∏£‡∏±‡∏ö Close ‡πÄ‡∏õ‡πá‡∏ô 50%
                const leadsCurrent = Math.ceil(closed / currentTotalConv); // Lead ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ target ‡∏ô‡∏µ‡πâ
                const leadsImproved = Math.ceil(closed / improvedConv);
                return (leadsCurrent - leadsImproved).toLocaleString();
            }));

            // Analyze Call Rate Weakness
            feedback.push(analyzeWeakness(rCall, 0.30, "Calling Success Rate", () => {
                const improvedConv = 0.30 * rMeet * rPres * rClose;
                const leadsCurrent = Math.ceil(closed / currentTotalConv);
                const leadsImproved = Math.ceil(closed / improvedConv);
                return (leadsCurrent - leadsImproved).toLocaleString();
            }));

            contentDiv.innerHTML = feedback.join("");
        }
    </script>
</body>
</html>
